#!/bin/sh
# Mitigates the vulneratiblities CVE-2021-44228 (Log4Shell) and the related CVE-2021-4104 
# The mitigation searches the specified folders for Java archives containing the offending
# Java classes and deletes the offending classes.
export PATH="/usr/lib/jvm/java-11-openjdk-amd64/bin"
# the XProc-Z web application archive is installed here
java -jar fix-CVE-2021-44228-1.0.1.jar /etc/xproc-z/
# web apps and extension libraries
java -jar fix-CVE-2021-44228-1.0.1.jar /var/lib/tomcat8/
# Tomcat's own binaries are here
java -jar fix-CVE-2021-44228-1.0.1.jar /usr/share/tomcat8/
# Solr's binaries are here
java -jar fix-CVE-2021-44228-1.0.1.jar /opt/solr/
# System Java libraries
java -jar fix-CVE-2021-44228-1.0.1.jar /usr/share/java/

